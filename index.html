<!DOCTYPE html>
<html>
<head>
<title>Gas Dashboard</title>
<script src="https://unpkg.com/mqtt/dist/mqtt.min.js"></script>
</head>

<body>

<h2>CONFIGURATION</h2>

Name:
<input id="name">
Register:
<input id="reg">
<button onclick="add()">Add</button>

<h2>LIVE VALUES</h2>

<table border="1" id="tbl">
<tr><th>Parameter</th><th>Value</th></tr>
</table>

<script>

let values={};

const client=mqtt.connect(
"wss://9623f16bf00e4cc69f0010261f43bf86.s1.eu.hivemq.cloud:8884/mqtt",
{username:"RITESH",password:"Ritesh@123"});

client.on("connect",()=>{
 client.subscribe("data/#");
});

function add(){
 let n=name.value;
 let r=reg.value;

 client.publish("config/"+n,r);

 let row=tbl.insertRow();
 row.id="row_"+n;
 row.insertCell(0).innerHTML=n;
 row.insertCell(1).innerHTML="--";
}

client.on("message",(t,m)=>{

 let p=t.split("/")[1];
 let val=m.toString();

 let row=document.getElementById("row_"+p);

 if(row){
   row.cells[1].innerHTML=val;
 }
});

</script>

</body>
</html>
